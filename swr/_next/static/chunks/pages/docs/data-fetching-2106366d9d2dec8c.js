(self.webpackChunk_N_E = self.webpackChunk_N_E || []).push([[492], { 2999: function (s, e, n) { (window.__NEXT_P = window.__NEXT_P || []).push(["/docs/data-fetching.html", function () { return n(4070) }]) }, 4070: function (s, e, n) { "use strict"; n.r(e), n.d(e, { __toc: function () { return a } }); var r = n(2676), l = n(3017), o = n(6952), i = n(4894), t = n(1530), c = n.n(t); let a = [{ depth: 2, value: "Fetch", id: "fetch" }, { depth: 2, value: "Axios", id: "axios" }, { depth: 2, value: "GraphQL", id: "graphql" }]; function h (s) { let e = Object.assign({ h1: "h1", pre: "pre", code: "code", span: "span", p: "p", strong: "strong", h2: "h2", a: "a", em: "em" }, (0, o.a)(), s.components); return (0, r.jsxs)(r.Fragment, { children: [(0, r.jsx)(e.h1, { children: "数据请求" }), "\n", (0, r.jsx)(e.pre, { "data-language": "js", "data-theme": "default", hasCopyCode: !0, children: (0, r.jsx)(e.code, { "data-language": "js", "data-theme": "default", children: (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " { " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "data" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "error" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " } " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "useSWR" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(key" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " fetcher)" })] }) }) }), "\n", (0, r.jsxs)(e.p, { children: ["这是 SWR 的基本 API。这里的 ", (0, r.jsx)(e.code, { children: "fetcher" }), " 是一个异步函数，它 ", (0, r.jsx)(e.strong, { children: "接受" }), " SWR 的 ", (0, r.jsx)(e.strong, { children: (0, r.jsx)(e.code, { children: "key" }) }), " 并返回数据。"] }), "\n", (0, r.jsxs)(e.p, { children: ["返回值将作为 ", (0, r.jsx)(e.code, { children: "data" }), " 传递，如果抛出错误，将作为 ", (0, r.jsx)(e.code, { children: "error" }), " 被捕获。"] }), "\n", (0, r.jsx)(i.UW, { emoji: "\uD83D\uDCA1", children: (0, r.jsxs)(e.p, { children: ["注意：如果 ", (0, r.jsx)("code", { children: "fetcher" }), " 是", (0, r.jsx)(c(), { href: "/docs/global-configuration.html", children: "全局配置" }), "提供的，可以从参数中忽略。"] }) }), "\n", (0, r.jsx)(e.h2, { id: "fetch", children: "Fetch" }), "\n", (0, r.jsxs)(e.p, { children: ["你可以使用任何库来处理数据请求，比如一个 ", (0, r.jsx)(e.code, { children: "fetch" }), " polyfill ", (0, r.jsx)(e.a, { href: "https://github.com/developit/unfetch", children: "developit/unfetch" }), "："] }), "\n", (0, r.jsx)(e.pre, { "data-language": "js", "data-theme": "default", hasCopyCode: !0, children: (0, r.jsxs)(e.code, { "data-language": "js", "data-theme": "default", children: [(0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "import" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " fetch " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "from" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'unfetch'" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "fetcher" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " url " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=>" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "fetch" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(url)" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: ".then" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(r " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=>" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "r" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: ".json" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "())" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "function" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "App" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " () {" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " { " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "data" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "error" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " } " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "useSWR" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'/api/data'" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " fetcher)" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-comment)" }, children: "// ..." })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "}" }) })] }) }), "\n", (0, r.jsx)(i.UW, { emoji: "\uD83D\uDCA1", children: (0, r.jsxs)(e.p, { children: ["如果你使用的是 ", (0, r.jsx)("strong", { children: "Next.js" }), "，则不需要引入这个 polyfill：", (0, r.jsx)("br", {}), "\n", (0, r.jsx)("a", { target: "_blank", rel: "noopener", href: "https://nextjs.org/blog/next-9-1-7#new-built-in-polyfills-fetch-url-and-objectassign.html", children: "新的内置 Polyfills： fetch()、URL、和Object.assign" })] }) }), "\n", (0, r.jsx)(e.h2, { id: "axios", children: "Axios" }), "\n", (0, r.jsx)(e.pre, { "data-language": "js", "data-theme": "default", hasCopyCode: !0, children: (0, r.jsxs)(e.code, { "data-language": "js", "data-theme": "default", children: [(0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "import" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " axios " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "from" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'axios'" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "fetcher" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " url " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=>" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "axios" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: ".get" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(url)" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: ".then" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(res " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=>" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "res" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: ".data)" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "function" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "App" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " () {" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " { " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "data" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "error" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " } " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "useSWR" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'/api/data'" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " fetcher)" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-comment)" }, children: "// ..." })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "}" }) })] }) }), "\n", (0, r.jsx)(e.h2, { id: "graphql", children: "GraphQL" }), "\n", (0, r.jsxs)(e.p, { children: ["或者配合类似 ", (0, r.jsx)(e.a, { href: "https://github.com/prisma-labs/graphql-request", children: "graphql-request" }), " 的库使用 GraphQL："] }), "\n", (0, r.jsx)(e.pre, { "data-language": "js", "data-theme": "default", hasCopyCode: !0, children: (0, r.jsxs)(e.code, { "data-language": "js", "data-theme": "default", children: [(0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "import" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " { request } " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "from" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'graphql-request'" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "fetcher" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " query " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=>" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "request" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "'/api/graphql'" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " query)" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: " " }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "function" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "App" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " () {" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "const" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " { " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "data" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-constant)" }, children: "error" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " } " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-keyword)" }, children: "=" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: " " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-function)" }, children: "useSWR" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "(" })] }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "    " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "`{" })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: '      Movie(title: "Inception") {' }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "        releaseDate" }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "        actors {" }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "          name" }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "        }" }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "      }" }) }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-token-string-expression)" }, children: "    }`" }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-punctuation)" }, children: "," })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "    fetcher" }) }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  )" }) }), "\n", (0, r.jsxs)(e.span, { className: "line", children: [(0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "  " }), (0, r.jsx)(e.span, { style: { color: "var(--shiki-token-comment)" }, children: "// ..." })] }), "\n", (0, r.jsx)(e.span, { className: "line", children: (0, r.jsx)(e.span, { style: { color: "var(--shiki-color-text)" }, children: "}" }) })] }) }), "\n", (0, r.jsx)(e.p, { children: (0, r.jsxs)(e.em, { children: ["如果要把变量传递给 GraphQL query，请查看 ", (0, r.jsx)(e.a, { href: "/docs/arguments.html", children: "多参数" }), "。"] }) })] }) } e.default = (0, l.j)({ MDXContent: function () { let s = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, { wrapper: e } = Object.assign({}, (0, o.a)(), s.components); return e ? (0, r.jsx)(e, { ...s, children: (0, r.jsx)(h, { ...s }) }) : h(s) }, pageOpts: { filePath: "pages/docs/data-fetching.mdx.html", route: "/docs/data-fetching.html", title: "数据请求", headings: a }, pageNextRoute: "/docs/data-fetching.html" }) } }, function (s) { s.O(0, [17, 888, 774, 179], function () { return s(s.s = 2999) }), _N_E = s.O() }])